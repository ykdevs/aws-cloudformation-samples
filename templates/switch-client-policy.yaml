AWSTemplateFormatVersion: "2010-09-09"
Description: |

  Make Switch Client Policy for Switch Administrator Access

Parameters:
  SwitchAwsAccountIds:
    Type: List<Number>
    Description: Comma Delimited List Ofã€€AWS AccountIds for Switch Role

Resources:

  SwitchClientPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: !Sub "SwitchClientPolicy-${AWS::StackName}"
      Description: !Sub "Generated by ${AWS::StackName}"
      PolicyDocument:
        Statement:
          - Effect: Allow
            Action: "sts:AssumeRole"
            Resource:
              - !Sub
                - "arn:aws:iam::${SwitchAwsAccountId}:role/SwitchAdministratorAccess"
                -  SwitchAwsAccountId: !Select [ "0", !Ref SwitchAwsAccountIds ]
              - !Sub
                - "arn:aws:iam::${SwitchAwsAccountId}:role/SwitchAdministratorAccess"
                -  SwitchAwsAccountId: !Select [ "1", !Ref SwitchAwsAccountIds ]
            Condition:
              BoolIfExists:
                aws:MultiFactorAuthPresent: "true"
        Version: 2012-10-17
